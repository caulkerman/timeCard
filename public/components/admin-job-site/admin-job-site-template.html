<link rel="stylesheet" href="components/admin-job-site/admin-job-site.css">

<p><span id="jobSiteNameBold">{{jobsite.name}}<span></p>


<button ng-click="showLateTCdiv()">Create Late Time Card</button>
<button ng-click="completedJob()">Completed</button>
<button ng-click="showUpdateForm()" ng-hide="showUpdateJobSite">Show Jobsite Details</button>
<button ng-click="hideUpdateForm()" ng-show="showUpdateJobSite">Hide Jobsite Details</button>


<form ng-show="showUpdateJobSite" ng-submit="updateTheJobSite(jobsite.contractor, jobsite.job_address, jobsite.job_details, jobsite.materials_needed, jobsite.name, jobsite.superintendent_name, jobsite.superintendent_telephone)">
    
    <p>You can edit and change the job site details</p>

    <p>Total Job Site Hours Worked: {{totalJobSiteHours}}</p>


    <div>
        <label for="name">Job Name: </label>
        <input type="text" class="updateJobSite" ng-model="jobsite.name" name="name">
    </div>

    <div >
        <label for="contractor">Contractor: </label>
        <input type="text" class="updateJobSite" ng-model="jobsite.contractor" name="contractor">
    </div>

    <div>
        <label for="superintendent_name">Superintendent Name: </label>
        <input type="text" class="updateJobSite" ng-model="jobsite.superintendent_name" name="superintendent_name">
    </div>

    <div>
        <label for="superintendent_telephone">Superintendant Telephone: </label>
        <input type="number" class="updateJobSite" ng-model="jobsite.superintendent_telephone" name="superintendent_telephone">
    </div>

    <div>
        <label for="job_address">Job Address: </label>
        <input type="text" class="updateJobSite" ng-model="jobsite.job_address" name="job_address">
    </div>

    <div>
        <label for="job_details">Job Details: </label>
        <textarea class="updateJobSite" ng-model="jobsite.job_details" name="job_details"></textarea>
    </div>

    <div>
        <label for="materials_needed">Materials Needed: </label>
        <textarea class="updateJobSite" ng-model="jobsite.materials_needed" name="materials_needed"></textarea>
    </div>

    

    

    <input type="submit" class="updateJobSite" value="Update Jobsite">
</form>

<div class="late-time-card-date" ng-show="showLateTC">
    <input type="text" placeholder="Example: May 2, 2016: Monday" ng-model="newDate">
    <button ng-click="createLateTimeCard(newDate)">Submit New Date</button>
</div>


    <!--  You need to set up a spot to show whether the job time is T&M, maybe use hide/show if it is.-->
       
    <br />
<!--<input type="text" placeholder="Filter the Dates" ng-model="filter_date"> -->
    
    <br />
    <div ng-repeat="timecard in dailyTCs | filter: {theDate:filter_date} track by $index">  
        <hr> 
            <div>

                <div ng-show="deleteWarning[$index]">
                    <p class="warn">Are you sure you want to delete this day's time dard?  Clicking yes will delete the whole time card for this day including all time, materials, employees, etc... You WILL NOT be able to get this day back</p>
                    <button ng-click="hideDeleteWarning($index)">NO</button>
                    <button ng-click="deleteTC($index)">YES</button>
                </div>
                
                <a ng-hide="showDTCs[$index]" href="" ng-click="showDailyTCs($index)" >{{timecard.theDate}}</a>
                <a href="" ng-show="showDTCs[$index]" ng-click="hideDailyTCs($index)" >{{timecard.theDate}}</a>
                <span ng-show="timecard.late">LATE!</span>
                <button ng-click="showDeleteWarning($index)">X</button>

                

                <div class="hidden-daily-time-card" ng-show="showDTCs[$index]"> 
                    
                    <!--MAKE SURE TO MAKE THESE STYLED AS display: block -->
                    <div>
                        <label for="materials">Materials Used: </label>
                        <textarea name="materials" ng-model="timecard.materials_used"></textarea></p>

                        <label for="notes">Notes: </label>
                        <textarea name="notes" ng-model="timecard.notes"></textarea>
                        <p ng-show="updating">UPDATING!</p>

                        <button ng-click="addMaterialsAndNotes(timecard.notes, timecard.materials_used, $index)">Submit Materials and Notes</button>
                    </div>
                    
                    <!-- THE TABLE -->
                    <table st-table="students" class="table table-striped">
                        <thead>
                            <tr>
                                <td>Employee Name</td>
                                <td>Hours Worked</td>
                                <td>bob</td>
                                <td>bill</td>
                            </tr>
                        </thead>

                        <tbody>
                            
                            <tr>
                                <td ng-show="badName" class="warn">Oops! There is something wrong with the employee's name</td>
                                <td ng-show="noName" class="warn">Oops!  You forgot the Employee Name</td> 
                                <td ng-show="name_already_exists" class="warn">Oops! This employee already has time for this day</td>                                
                                <td ng-hide="hide_late_employee_td"><input type="text" ng-model="late_employee" placeholder="Add Missing Employee"></td>
                                <td ng-show="noTime" class="warn">Oops!  You forgot to enter hours</td>                                
                                <td ng-hide="hide_late_hours_td"><input type="number" min=".25" max="24" ng-model="late_hours" placeholder="Hours"></td>
                                <td></td>
                                <td></td>
                                <td><button ng-click="lateEmployee(late_employee, late_hours, $index, timecard.theDate)" >Submit</button></td>
                            </tr>

                            <tr ng-repeat="employees in timecard.employees_worked track by $index" > <!--make sure to ng-repeat this -->
                                <td>{{employees.employeeName}}</td>
                                <td>{{employees.hours_worked}}</td>
                                <td><button ng-click="showTheEditHours($parent.$index, $index)" ng-hide="editHours[$parent.$index][$index]">Edit Hours</button>
                                
                                <td><input ng-show="editHours[$parent.$index][$index]" type="number" min=".25" max="24" ng-model="newHours">
                                    <p ng-show="editHours[$parent.$index][$index]">
                                        Note: The new hours will not be updated until the employee approves of the change.
                                    </p>
                                </td>
                                <!--<td><button ng-click="editEmployee(employees.hours_worked, employees._id)">Edit</button></td>-->
                                <td ng-show="editHours[$parent.$index][$index]"><button ng-click="editEmployee(newHours, employees._id, $parent.$index, $index)">submit</button>
                                <td><button ng-click="deleteEmployeeFromTC($parent.$index, $index)">Delete</button>
                            </tr>
                        </tbody>
                    </table>
                
                </div>

            </div>

        <hr>
    </div>

    <p ng-show="finalFarewell">This job site has been moved to the admin-old-job-sites page</p>
    



